<html>
    <body>
        <form onsubmit="saveToLocalStorage(event)">
           <label for="amount">Choose Expense Amount </label> 
           <input type="number" id="amount" required> 
           <label for="description">Expense Description </label> 
           <input type="text" id="description" required>
           <label for="category">Choose Category </label> 
           <select name="category" id="category">
            <option value="investment">Investment</option>
            <option value="food">Food</option>
            <option value="grocery">Grocery</option>
            <option value="entertainment">Entertainment</option>
           </select>
           <button id="submit">Add expense </button>
        </form>
        <ul id="listOfUsers"></ul>
        <script>
            function saveToLocalStorage(event) {
                event.preventDefault();
                const amount = event.target.amount.value;
                const description = event.target.description.value;
                const category = event.target.category.value;
                const obj = {
                    amount,
                    description,
                    category
                }
                localStorage.setItem(obj.description, JSON.stringify(obj))
                showNewUserOnScreen(obj);
            }

            window.addEventListener("DOMContentLoaded", () => {
                const localStorageObj = localStorage;
                const localstoragekeys  = Object.keys(localStorageObj)

                for(var i =0; i< localstoragekeys.length; i++){
                    const key = localstoragekeys[i]
                    const userDetailsString = localStorageObj[key];
                    const userDetailsObj = JSON.parse(userDetailsString);
                    showNewUserOnScreen(userDetailsObj)
                }
            })

            function showNewUserOnScreen(user){
                amount.value = '';
                description.value = '';
                document.getElementById('category').value ='';
            
                if(localStorage.getItem(user.description) !== null){
                    removeUserFromScreen(user.description)
                }

                const parentNode = document.getElementById('listOfUsers');
                const childHTML = `<li id=${user.amount}> ${user.amount} - ${user.description} - ${user.category}
                                        <button onclick=deleteUser('${user.description}')> Delete User </button>
                                        <button onclick=editUserDetails('${user.amount}','${user.description}','${user.category}')>Edit User </button>
                                     </li>`

                parentNode.innerHTML = parentNode.innerHTML + childHTML;
            }

            //Edit User

            function editUserDetails(amount, description, category){

                document.getElementById('amount').value = amount;
                document.getElementById('description').value = description;
                document.getElementById('category').value =category;

                //deleteUser(description)
             }


            function deleteUser(description){
                localStorage.removeItem(description);
                removeUserFromScreen(description);

            }

            function removeUserFromScreen(description){
                const parentNode = document.getElementById('listOfUsers');
                const childNodeToBeDeleted = document.getElementById(description);
                if(childNodeToBeDeleted) {
                    parentNode.removeChild(childNodeToBeDeleted)
                }
            }

        </script>
    </body>
</html>